# Предсказание агрохимических свойств почв Северного Казахстана с использованием мультимодальных спутниковых данных и методов машинного обучения

---

## Аннотация

Точное земледелие требует оперативной и пространственно-детальной информации о состоянии почв, однако традиционные лабораторные анализы остаются дорогостоящими и трудоёмкими. В данной работе представлен комплексный пайплайн предсказания шести ключевых агрохимических свойств почв — pH (KCl), содержания органического углерода (SOC), нитратов (NO₃), подвижного фосфора (P₂O₅), обменного калия (K₂O) и серы (S) — для сельскохозяйственных угодий Северного Казахстана на основе мультиисточниковых спутниковых данных. Набор данных включает 1085 полевых образцов с лабораторным анализом за 2022–2023 гг. В качестве предикторов использованы данные Sentinel-2, Landsat-8, Sentinel-1 SAR, цифровой модели рельефа SRTM, почвенных карт SoilGrids и климатических данных ERA5. Из исходных данных сформировано 536 признаков, из которых для каждого целевого свойства отобраны 15 наиболее информативных. Проведено сравнение 12 моделей машинного обучения: Random Forest (RF), XGBoost, CatBoost, CART, Extra Trees (ET), Gradient Boosted Decision Trees (GBDT), K-ближайших соседей (KNN), линейная регрессия (LR), Ridge, SGD, SVR, а также архитектуры глубокого обучения — 1D CNN на табличных признаках, ResNet-18 на 13–18-канальных спутниковых патчах и ConvNeXt на мультисезонных 54-канальных композитах. Все модели оценены с применением пространственной стратегии Leave-One-Field-Out Cross-Validation (LOFO-CV), исключающей утечку данных за счёт пространственной автокорреляции. Наилучшие результаты по коэффициенту ранговой корреляции Спирмена (ρ) достигнуты ансамблевыми методами: GBDT для pH (ρ = 0.857), RF для SOC (ρ = 0.731) и ET для NO₃ (ρ = 0.768). Ablation study на CNN-архитектурах показало, что оптимальный размер патча составляет 32×32 пикселей, а добавление индекса NDVI к базовым 13 каналам повышает R² для pH до 0.878. Мультисезонный ConvNeXt продемонстрировал преимущество для NO₃ (R² = 0.575), однако уступил табличным ансамблевым методам для большинства свойств.

**Ключевые слова:** цифровое почвенное картирование, машинное обучение, глубокое обучение, Sentinel-2, пространственная кросс-валидация, Северный Казахстан, точное земледелие

---

## 1. Введение

Почвенные ресурсы являются фундаментальной основой устойчивого сельскохозяйственного производства и продовольственной безопасности. Деградация почв затрагивает около 33% мировых земельных ресурсов (FAO, 2015), а убытки от снижения почвенного плодородия оцениваются в 10.6 трлн долларов ежегодно (UNCCD, 2022). Своевременный и пространственно-детальный мониторинг агрохимических свойств почв является необходимым условием точного земледелия (precision agriculture) — парадигмы, направленной на оптимизацию внесения удобрений, снижение экологической нагрузки и повышение урожайности (Gebbers & Adamchuk, 2010). Традиционные методы оценки агрохимических свойств основаны на отборе полевых проб с последующим лабораторным анализом, что связано со значительными временными (2–4 недели) и финансовыми затратами (15–50 USD за образец для комплексного анализа) (Viscarra Rossel et al., 2006). Эти ограничения делают прямое обследование непрактичным для мониторинга больших территорий с высоким временным разрешением.

Особенно остро проблема оперативного мониторинга стоит для обширных территорий аридных и полуаридных зон, к которым относятся сельскохозяйственные угодья Центральной Азии. Северный Казахстан — один из крупнейших зернопроизводящих регионов мира, где сосредоточено свыше 20 млн га пашни (Swinnen et al., 2017). Регион характеризуется резко континентальным климатом, короткими вегетационными период и высокой уязвимостью почв к ветровой эрозии и дефляции — проблемами, усугубляемыми изменением климата (Kraemer et al., 2015). Несмотря на стратегическое значение региона, систематические исследования цифрового почвенного картирования для Казахстана остаются крайне немногочисленными, в отличие от хорошо изученных территорий Европы, Китая и Бразилии.

### 1.1 Дистанционное зондирование для оценки почвенных свойств

Развитие технологий дистанционного зондирования Земли (ДЗЗ) открывает возможности для оперативного и пространственно-непрерывного оценивания почвенных свойств. Физической основой является взаимодействие электромагнитного излучения с почвенной поверхностью и растительным покровом: отражательная способность в видимом и ближнем инфракрасном (VNIR, 400–1000 нм) диапазонах чувствительна к содержанию органического вещества, оксидов железа и минералогическому составу, тогда как коротковолновая инфракрасная область (SWIR, 1000–2500 нм) несёт информацию о влажности и глинистых минералах (Ben-Dor et al., 2009; Viscarra Rossel & Behrens, 2010).

Спутниковые системы нового поколения — Sentinel-2 (Drusch et al., 2012) и Landsat-8 (Roy et al., 2014) — обеспечивают мультиспектральные данные с пространственным разрешением 10–30 м и временным разрешением 5–16 дней, что позволяет рассчитывать спектральные индексы (NDVI, GNDVI, BSI, MSI и др.), чувствительные к вегетационной активности, влажности почв и минеральному составу. Castaldi et al. (2019) показали, что данные Sentinel-2 позволяют предсказывать SOC на пахотных землях с R² до 0.70 при условии наблюдения обнажённой почвы. Vaudour et al. (2019) продемонстрировали потенциал Sentinel-2 для картирования pH, SOC и текстуры верхних горизонтов в умеренных агроэкосистемах.

Радарные данные Sentinel-1 SAR (Torres et al., 2012), работающие независимо от облачности и освещённости, дополняют оптические наблюдения информацией о диэлектрических свойствах, структуре и влажности поверхностного слоя почвы. Показано, что интеграция SAR-данных с оптическими повышает точность оценки влажности почв на 8–15% (Bauer-Marschallinger et al., 2019). Цифровые модели рельефа (SRTM) предоставляют информацию о геоморфологических характеристиках (уклон, экспозиция, кривизна, топографический индекс влажности), определяющих перераспределение влаги и эрозионные процессы (Wilson & Gallant, 2000). Глобальные почвенные карты SoilGrids (Hengl et al., 2017) обеспечивают фоновую информацию о гранулометрическом составе, ёмкости катионного обмена и других педологических свойствах с разрешением 250 м.

Особый интерес представляет использование **мультисезонных спутниковых данных**, поскольку спектральный отклик сельскохозяйственных территорий существенно меняется в течение вегетационного периода: от обнажённой почвы ранней весной до максимальной биомассы летом и стерни осенью. Каждая фенологическая фаза несёт уникальную информацию о подстилающих почвенных свойствах (Žížala et al., 2022).

### 1.2 Машинное и глубокое обучение в цифровом почвенном картировании

Методы машинного обучения (ML) нашли широкое применение в задачах цифрового почвенного картирования (Digital Soil Mapping, DSM), начиная с пионерской работы McBratney et al. (2003), сформулировавшей концептуальную модель SCORPAN (Soil = f(s, c, o, r, p, a, n)). Ансамблевые алгоритмы — Random Forest (Breiman, 2001), градиентный бустинг (Friedman, 2001), XGBoost (Chen & Guestrin, 2016), CatBoost (Dorogush et al., 2018) — продемонстрировали высокую эффективность в предсказании pH, SOC, содержания макро- и микроэлементов в различных биоклиматических зонах. Систематический обзор Wadoux et al. (2020) показал, что Random Forest является наиболее часто используемым алгоритмом в DSM, обеспечивая медианный R² = 0.50–0.65 для SOC и 0.55–0.75 для pH в зависимости от размера выборки и пространственного масштаба.

Однако большинство опубликованных исследований используют случайное разбиение на обучающую и тестовую выборки (random split), не учитывая пространственную автокорреляцию между образцами. Roberts et al. (2017) и Wadoux et al. (2021) убедительно показали, что такой подход систематически завышает оценки качества моделей на 15–40% по сравнению с пространственными стратегиями валидации (spatial cross-validation), поскольку пространственно близкие образцы, попадающие одновременно в train и test, создают «эффект утечки» (data leakage). Spatial Leave-One-Group-Out (LOGO) и Leave-One-Field-Out (LOFO) стратегии обеспечивают наиболее реалистичные оценки генерализующей способности моделей для картирования ранее не обследованных территорий (Meyer & Pebesma, 2021).

Глубокое обучение (Deep Learning, DL) представляет перспективное, но менее изученное направление в DSM. Первые работы применяли полносвязные нейронные сети к извлечённым табличным признакам (Padarian et al., 2019), демонстрируя конкурентные результаты с RF. Behrens et al. (2018) использовали CNN на суперпиксельных патчах рельефа для предсказания типов почв. Более поздние исследования (Zhong et al., 2024; Wadoux, 2019) показали, что CNN, обученные непосредственно на мультиспектральных спутниковых патчах (end-to-end), способны извлекать пространственные паттерны, недоступные при табличном моделировании, однако их преимущество проявляется преимущественно на больших датасетах (>5000 образцов). Архитектуры семейства ConvNeXt (Liu et al., 2022) — модернизированные CNN, включающие depthwise convolution, Layer Normalization и блоки Squeeze-and-Excitation (Hu et al., 2018), — продемонстрировали превосходство над ResNet в задачах компьютерного зрения, но их применение к мультисезонным мультиспектральным почвенным данным ранее не исследовалось.

### 1.3 Исследовательский разрыв и цели работы

Анализ литературы позволяет выделить следующие исследовательские лакуны:

1. **Географический разрыв**: подавляющее большинство работ по DSM выполнено для территорий Европы, Китая (Yangtze River Delta, Loess Plateau), Южной Америки и Австралии. Для Центральной Азии — региона со специфическими чернозёмно-каштановыми почвами, резко континентальным климатом и обширными целинными территориями — систематических исследований мультимодального DSM практически не проводилось.

2. **Методологический разрыв**: большинство работ сравнивают ограниченный набор из 2–4 моделей и используют random split. Комплексное сравнение >10 ML-алгоритмов и нескольких DL-архитектур со строгой пространственной кросс-валидацией (LOFO-CV) остаётся редкостью.

3. **Архитектурный разрыв**: потенциал современных CNN-архитектур (ConvNeXt, SE-блоки), обученных на мультисезонных мультиканальных спутниковых патчах для почвенных задач, не исследован. Systematische ablation studies размера патча и конфигурации каналов отсутствуют.

4. **Целевой разрыв**: большинство работ фокусируются на SOC и pH; предсказание макро- и мезоэлементов (NO₃, P₂O₅, K₂O, S) остаётся значительно менее изученным, несмотря на их критическое значение для управления удобрениями.

Целью данной работы является разработка и сравнительный анализ методов ML и DL для предсказания шести агрохимических свойств почв Северного Казахстана на основе мультимодальных спутниковых данных, с использованием строгой стратегии пространственной кросс-валидации. Основной вклад работы:

1. Создание комплексного пайплайна извлечения **536 мультимодальных признаков** из шести спутниковых и климатических источников с 12-стадийной обработкой через Google Earth Engine;
2. Систематическое сравнение **12 ML-моделей** (RF, XGBoost, CatBoost, GBDT, ET, CART, KNN, LR, Ridge, SGD, SVR, 1D CNN) и **3 DL-архитектур** (1D CNN, ResNet-18, ConvNeXt) с применением Spatial LOFO-CV, исключающей пространственную утечку данных;
3. Первое, насколько нам известно, **ablation study** влияния размера спутниковых патчей (16×16, 32×32, 64×64) и числа дополнительных спектральных индексов (0–5) на качество CNN для задач DSM;
4. Предложение и оценка **мультисезонной ConvNeXt-архитектуры** с SE-блоками на 54-канальных спутниковых композитах для шести агрохимических свойств;
5. Демонстрация того, что ансамблевые табличные модели на тщательно отобранных признаках остаются **конкурентоспособными** по сравнению с end-to-end DL-подходами при ограниченных объёмах почвенных данных (~1000 образцов).

---

## 2. Район исследования и данные

### 2.1 Район исследования

Исследование проведено на сельскохозяйственных угодьях Северного Казахстана, расположенных в пределах Костанайской, Акмолинской и Северо-Казахстанской областей (приблизительно 50°–54° с.ш., 64°–72° в.д.). Регион является частью Казахстанской целинной зоны — одного из крупнейших зернопроизводящих регионов Центральной Азии, где сосредоточено около 80% пахотных земель страны (Kraemer et al., 2015).

**Климат.** Территория характеризуется резко континентальным климатом с большими амплитудами сезонных и суточных температур. Среднегодовая температура воздуха варьирует от +0.5 до +3.0 °C, с зимними минимумами до −40 °C и летними максимумами свыше +35 °C. Среднегодовое количество осадков составляет 250–400 мм, из которых до 40% приходится на летний период (июнь–август). По классификации Кёппена-Гейгера, климат относится к типам Dfb (влажный континентальный) и BSk (полуаридный холодный степной), что определяет уязвимость региона к засухам и ветровой эрозии (Fick & Hijmans, 2017). Вегетационный период (среднесуточная температура >5 °C) продолжается с конца апреля по сентябрь (130–150 дней), а сумма активных температур (>10 °C) составляет 2000–2600 °C·дней.

**Почвы.** Почвенный покров представлен преимущественно чернозёмами обыкновенными и южными (Haplic Chernozems по классификации WRB), а также каштановыми почвами (Kastanozems) в южной части исследуемой территории. Содержание гумуса в пахотном горизонте (0–30 см) варьирует от 2% до 6%, закономерно убывая с севера на юг. Гранулометрический состав преимущественно суглинистый (средний и тяжёлый суглинок), с содержанием физической глины (<0.01 мм) 35–55%. Длительное сельскохозяйственное освоение (с 1954 г. — «Целинная кампания») привело к значительной трансформации верхних горизонтов: дегумификации, уплотнению и повышению дефляционной уязвимости. pH пахотного горизонта варьирует от слабокислого (5.3) до слабощелочного (8.0), что отражает зональную неоднородность материнских пород и интенсивность карбонатного выщелачивания.

**Рельеф.** Территория представляет собой слабоволнистую равнину с абсолютными высотами от 180 до 420 м над уровнем моря. Рельеф характеризуется наличием пологих увалов, западин и балочных систем, определяющих перераспределение влаги и формирование мозаичных почвенных микрокомплексов. Уклоны поверхности преимущественно слабые (0–3°), что обуславливает преобладание ветровой эрозии над водной.

**Сельское хозяйство.** Основные сельскохозяйственные культуры — яровая мягкая пшеница (*Triticum aestivum* L.), ячмень (*Hordeum vulgare* L.), масличные (подсолнечник, рапс, лён) и зернобобовые. Применяется преимущественно минимальная и нулевая обработка почвы (no-till), доля которой возросла с 15% до 45% за 2010–2023 гг. Системы удобрения дифференцированы: от полного отсутствия минеральных удобрений на мелких хозяйствах до интенсивного внесения NP на крупных агрохолдингах (60–90 кг/га азота, 20–40 кг/га фосфора в д.в.). Эта гетерогенность агрохимических практик создаёт дополнительную сложность для пространственного моделирования почвенных свойств.

### 2.2 Полевые данные

Набор данных включает 1085 образцов почв, собранных в ходе плановых агрохимических обследований за два полевых сезона: 174 образца в 2022 г. и 911 образцов в 2023 г. Образцы отобраны из пахотного горизонта (0–25 см) в соответствии с методикой агрохимического обследования сельскохозяйственных угодий Республики Казахстан (ГОСТ 17.4.3.01-83; ГОСТ 28168-89). Пробоотбор проводился в период после уборки урожая (сентябрь–октябрь) методом элементарного участка: каждый образец представляет собой смешанную пробу из 15–20 точечных уколов, равномерно распределённых по площади элементарного участка (20–50 га).

Координаты центроидов полевых участков зафиксированы GNSS-приёмником с точностью ±3 м. Каждому образцу присвоен уникальный идентификатор поля (`field_name`), позволяющий группировать образцы по пространственным единицам для корректной кросс-валидации. В 2022 г. обследовано 40 полей, в 2023 г. — 168 полей; в ряде случаев одно поле было представлено несколькими образцами (2–8 проб на поле), что отражает внутриполевую вариабельность. Общее количество уникальных полевых участков — 186.

Для каждого образца проведён лабораторный анализ аккредитованной лабораторией по следующим стандартным методикам:

- **pH (KCl)** — потенциометрическое определение кислотности в солевой вытяжке 1М KCl (ГОСТ 26483-85), отражающее обменную кислотность почвы;
- **Гумус (%)** → **SOC (%)** — определение органического вещества по методу Тюрина (мокрое сжигание дихроматом калия в серной кислоте, ГОСТ 26213-91); содержание органического углерода рассчитано из гумуса по коэффициенту Ван-Беммелена: SOC = HU × 0.58 (Van Bemmelen, 1890);
- **NO₃ (мг/кг)** — ионометрическое определение нитратного азота в водной вытяжке (ГОСТ 26951-86);
- **P₂O₅ (мг/кг)** — подвижный фосфор по методу Мачигина (извлечение 1% (NH₄)₂CO₃, ГОСТ 26205-91), адаптированному для карбонатных почв;
- **K₂O (мг/кг)** — обменный калий по методу Мачигина (ГОСТ 26205-91);
- **S (мг/кг)** — подвижная сера, извлечённая раствором KCl, определена турбидиметрически.

Описательная статистика целевых переменных представлена в Таблице 1. Выбор именно этих шести свойств обусловлен их ключевой ролью в управлении почвенным плодородием: pH контролирует доступность большинства элементов питания; SOC определяет структуру, водоудерживающую способность и биологическую активность почвы; NO₃, P₂O₅, K₂O и S — основные макроэлементы, лимитирующие урожайность зерновых в степной зоне Казахстана.

**Таблица 1.** Описательная статистика агрохимических свойств почв (n = 1085)

| Свойство | n | Среднее | Медиана | SD | Мин | Макс | CV, % | Асимметрия | Эксцесс |
|---|---|---|---|---|---|---|---|---|---|
| pH (KCl) | 1085 | 6.99 | 7.30 | 0.66 | 5.30 | 8.00 | 9.4 | −0.92 | −0.62 |
| SOC, % | 1085 | 2.45 | 2.44 | 0.55 | 0.64 | 4.41 | 22.4 | −0.26 | 1.98 |
| NO₃, мг/кг | 1085 | 10.88 | 9.29 | 7.90 | 0.16 | 64.00 | 72.6 | 2.43 | 9.33 |
| P₂O₅, мг/кг | 1085 | 25.77 | 18.80 | 20.31 | 3.22 | 150.00 | 78.8 | 2.54 | 8.15 |
| K₂O, мг/кг | 1085 | 650.62 | 664.00 | 166.66 | 106.00 | 1204.00 | 25.6 | −0.49 | 0.80 |
| S, мг/кг | 1085 | 8.81 | 6.89 | 7.62 | 0.92 | 62.80 | 86.4 | 3.54 | 14.29 |

Коэффициент вариации (CV) существенно различается между свойствами: наименьшая вариабельность характерна для pH (CV = 9.4%), наибольшая — для S (CV = 86.4%) и P₂O₅ (CV = 78.8%). Тест Шапиро-Уилка (Таблица 2) подтвердил, что распределения всех свойств значимо отличаются от нормального (p < 0.001), что обосновывает использование непараметрического коэффициента ранговой корреляции Спирмена (ρ) в качестве основной метрики качества моделей.

**Таблица 2.** Результаты теста Шапиро-Уилка на нормальность распределений

| Свойство | W-статистика | p-значение | Нормальность (α = 0.05) |
|---|---|---|---|
| pH (KCl) | 0.833 | 3.32 × 10⁻³² | Отклонена |
| SOC, % | 0.956 | 1.61 × 10⁻¹⁷ | Отклонена |
| NO₃, мг/кг | 0.805 | 3.23 × 10⁻³⁴ | Отклонена |
| P₂O₅, мг/кг | 0.725 | 6.53 × 10⁻³⁹ | Отклонена |
| K₂O, мг/кг | 0.976 | 2.44 × 10⁻¹² | Отклонена |
| S, мг/кг | 0.592 | 1.10 × 10⁻⁴⁴ | Отклонена |

**Таблица 3.** Описательная статистика по годам

| Год | Свойство | n | Среднее | Медиана | SD |
|---|---|---|---|---|---|
| 2022 | pH (KCl) | 174 | 6.51 | 6.80 | 0.70 |
| 2022 | SOC, % | 174 | 2.40 | 2.61 | 0.65 |
| 2022 | NO₃, мг/кг | 174 | 5.61 | 4.74 | 3.75 |
| 2022 | P₂O₅, мг/кг | 174 | 22.02 | 14.11 | 16.48 |
| 2022 | K₂O, мг/кг | 174 | 594.18 | 602.00 | 207.16 |
| 2022 | S, мг/кг | 174 | 7.49 | 6.34 | 3.81 |
| 2023 | pH (KCl) | 911 | 7.08 | 7.40 | 0.60 |
| 2023 | SOC, % | 911 | 2.46 | 2.44 | 0.53 |
| 2023 | NO₃, мг/кг | 911 | 11.89 | 10.00 | 8.08 |
| 2023 | P₂O₅, мг/кг | 911 | 26.49 | 19.60 | 20.90 |
| 2023 | K₂O, мг/кг | 911 | 661.40 | 670.00 | 155.57 |
| 2023 | S, мг/кг | 911 | 9.06 | 6.95 | 8.12 |

Тест Крускала-Уоллиса подтвердил статистически значимые межгодовые различия для pH, NO₃, P₂O₅ и K₂O (p < 0.001), что указывает на необходимость включения данных обоих лет в единый набор для обеспечения генерализующей способности моделей.

---

## 3. Материалы и методы

### 3.1 Источники спутниковых данных

Для каждого полевого участка извлечены данные из шести независимых источников через платформу Google Earth Engine (GEE; Gorelick et al., 2017), обеспечивающую облачные вычисления на петабайтном архиве спутниковых данных.

**Таблица 4.** Источники спутниковых и вспомогательных данных

| Источник | Платформа / Датасет | Параметры | Разрешение | Временное покрытие |
|---|---|---|---|---|
| Sentinel-2 (S2) | COPERNICUS/S2_SR_HARMONIZED | 12 спектральных каналов (B1–B12) + 5 индексов (NDVI, NDRE, GNDVI, SAVI, EVI) | 10–60 м | Апрель–октябрь 2022–2023 |
| Landsat-8 (L8) | LANDSAT/LC08/C02/T1_L2 | 6 каналов (B2–B7) + 3 индекса (NDVI, GNDVI, BSI) | 30 м | Апрель–октябрь 2022–2023 |
| Sentinel-1 (S1) | COPERNICUS/S1_GRD | SAR поляризации VV, VH (IW mode, ascending orbit) | 10 м | Весь год 2022–2023 |
| SRTM DEM | USGS/SRTMGL1_003 | Высота, уклон, экспозиция, кривизна, TPI | 30 м | Статический |
| SoilGrids v2.0 | ISRIC/SoilGrids | Песок, ил, глина, SOC, pH, CEC, N (0–200 см, 6 слоёв) | 250 м | Статический |
| ERA5-Land | ECMWF/ERA5_LAND | Температура (2 м), осадки, GDD, показатели вегетационного периода | ~9 км | Ежемесячно, 2022–2023 |

**Sentinel-2.** Использованы данные Surface Reflectance уровня L2A с атмосферной коррекцией алгоритмом Sen2Cor. Для каждого участка извлечены сезонные медианные композиты (для снижения влияния облачности и случайного шума) по четырём фенологическим окнам: весна (апрель–май), лето (июнь–июль), позднее лето (август), осень (сентябрь–октябрь). Маскирование облачности выполнено с использованием канала QA60 (порог ≤10% облачности на сцену). Радиометрические значения масштабированы в диапазон 0–1. Рассчитаны пять спектральных индексов: NDVI = (B8−B4)/(B8+B4), NDRE = (B8−B5)/(B8+B5), GNDVI = (B8−B3)/(B8+B3), SAVI = 1.5×(B8−B4)/(B8+B4+0.5) и EVI = 2.5×(B8−B4)/(B8+6×B4−7.5×B2+1).

**Landsat-8.** Использован продукт Collection 2, Tier 1, Level 2 (Surface Reflectance). Масштабирование коэффициентов отражения применено согласно документации (множитель 0.0000275, смещение −0.2). Рассчитаны три индекса: NDVI, GNDVI и BSI = ((B6+B4)−(B8+B2))/((B6+B4)+(B8+B2)). Данные L8 дополняют S2 в периоды высокой облачности и используются как независимый источник для верификации.

**Sentinel-1 SAR.** Извлечены данные режима Interferometric Wide (IW), наклонного зондирования VV и VH поляризаций в дБ (Ground Range Detected, калиброванный γ⁰). Для каждого участка рассчитаны сезонные медианы бэкскаттера, а также временные статистики (среднее, стандартное отклонение). Физическая основа использования SAR — чувствительность VV-поляризации к объёмной влажности почвы, а VH — к шероховатости поверхности и вегетационной биомассе (Torres et al., 2012).

**SRTM DEM.** Из цифровой модели рельефа извлечены пять производных: абсолютная высота, уклон (slope), экспозиция (aspect), кривизна профиля (profile curvature) и топографический индекс позиции (TPI, Topographic Position Index). TPI рассчитан как разность между высотой пикселя и средней высотой в окне 300 м, что позволяет идентифицировать гребни, склоны и западины.

**SoilGrids v2.0.** Извлечены педологические переменные для шести стандартных глубинных слоёв (0–5, 5–15, 15–30, 30–60, 60–100, 100–200 см): содержание песка, ила и глины (%), органический углерод (г/кг), pH (H₂O), ёмкость катионного обмена (CEC, cmol(+)/кг) и азот (г/кг). Данные SoilGrids используются как фоновые (prior) предикторы, отражающие крупномасштабные почвенные тренды.

**ERA5-Land.** Извлечены климатические переменные: среднемесячная температура воздуха на высоте 2 м, суммарные осадки, сумма активных температур (Growing Degree Days, GDD) и характеристики вегетационного периода (начало, конец, продолжительность). Рассчитаны агрегированные климатические композиты: среднегодовая температура (MAT), годовая сумма осадков (MAP), средняя температура и осадки вегетационного периода (GS_temp, GS_precip) (Muñoz-Sabater et al., 2021).

### 3.2 Пайплайн извлечения признаков

Извлечение признаков реализовано в виде 12-стадийного пайплайна, каждый этап которого формирует отдельный CSV-файл:

1. **s01_temperature** — извлечение температурных профилей из ERA5 и определение сезонных окон (весна, лето, позднее лето, осень);
2. **s02_sentinel2** — извлечение 12 каналов S2 и расчёт 5 спектральных индексов для каждого сезона с применением маскирования облачности;
3. **s03_landsat8** — аналогичная процедура для 6 каналов L8 с масштабированием и расчётом 3 индексов;
4. **s04_sentinel1** — извлечение SAR-бэкскаттера (VV, VH);
5. **s05_topography** — извлечение топографических характеристик из SRTM (высота, уклон, экспозиция, кривизна, TPI);
6. **s06_soil_maps** — извлечение почвенных свойств из SoilGrids по глубинным слоям (0–200 см);
7. **s07_hyperspectral** — проверка доступности гиперспектральных данных PRISMA/EnMAP (не доступны для региона);
8. **s08_merge_features** — объединение всех источников в единый мастер-датасет по ключу `field_name + year`;
9. **s09_climate** — расчёт климатических композитов (MAT, MAP, GS_temp, GS_precip);
10. **s10_semivariogram** — анализ пространственной автокорреляции (информационный);
11. **s11_spectral_eng** — инженерия признаков: EVI, отношения каналов (B3/B4, B11/B8), PCA на спектральных индексах;
12. **s12_glcm** — текстурные признаки GLCM (контраст, энтропия, диссимиляция, ASM, IDM) по каналам Red и NIR.

В результате объединения сформирован мастер-датасет из **536 признаков**, включающий следующие группы:

- **Спектральные каналы и индексы** (S2, L8): сезонные медианы 12 каналов S2 × 4 сезона + 5 индексов × 4 сезона + 6 каналов L8 × 4 сезона + 3 индекса L8 × 4 сезона = **164 признака**;
- **Временны́е характеристики**: межсезонные дельты (Δ = лето − весна, позднее лето − лето, осень − позднее лето), амплитуды (max − min), стандартные отклонения по сезонам для каждого канала/индекса = **~120 признаков**;
- **SAR-признаки** (S1): сезонные медианы VV и VH, временные статистики = **16 признаков**;
- **Топографические** (SRTM): высота, уклон, экспозиция, кривизна, TPI = **5 признаков**;
- **Почвенные** (SoilGrids): 7 переменных × 6 глубинных слоёв = **42 признака**;
- **Климатические** (ERA5): MAT, MAP, GS_temp, GS_precip, GDD = **5 признаков**;
- **Текстурные GLCM-признаки**: 5 метрик (контраст, энтропия, диссимиляция, ASM, IDM) × 2 канала (Red, NIR) × 4 сезона = **40 признаков**;
- **Инженерные признаки**: отношения каналов (B3/B4, B11/B8, B11/B12), PCA на спектральных индексах (первые 3–5 компонент) = **~30 признаков**;
- **Мультисенсорные композиты**: межплатформенные разности (S2_NDVI − L8_NDVI) и отношения = **~14 признаков**.

Обработка пропущенных значений выполнена следующим образом: для сезонных медианных композитов пропуски, вызванные устойчивой облачностью (>90% облачных сцен в окне), заполнены линейной интерполяцией по соседним сезонам; для SAR-данных пропуски отсутствовали; статические признаки (DEM, SoilGrids) не содержали пропусков. Итоговый процент пропущенных значений в мастер-датасете составил <0.3%.

### 3.2.1 Отбор признаков

Для каждого целевого свойства выполнен двухэтапный отбор признаков:

1. **Предварительная фильтрация**: удалены признаки с дисперсией <10⁻⁶ (quasi-constant), а также один из каждой пары признаков с попарной корреляцией Пирсона |r| > 0.95 (удалялся признак с меньшим индивидуальным Spearman ρ к целевой переменной);
2. **Ранжирование по важности**: из оставшихся ~250–300 признаков отобраны **15 наиболее значимых** методом Mean Decrease Impurity (MDI) из Random Forest (n_estimators=300), обученного на полном обучающем наборе. Выбор K=15 обосновывается анализом кривых «число признаков — качество модели», показавшим выход на плато при 12–18 признаках для всех свойств.

Примеры отобранных признаков: для pH — `spectral_GNDVI_spring`, `glcm_glcm_nir_ent_autumn`, `ts_s2_MSI_std`, `delta_s2_BSI_summer_to_late_summer`, `soilgrids_pH_0-5cm`; для SOC — `ts_s2_MSI_std`, `topo_DEM`, `climate_GS_precip`, `s2_NDWI_spring`, `soilgrids_SOC_0-5cm`; для NO₃ — `soilgrids_Mg_0-5cm`, `glcm_nir_idm_summer`, `l8_GNDVI_spring`, `delta_s2_NDVI_spring_to_summer`.

### 3.3 Подготовка спутниковых патчей для CNN

Для моделей глубокого обучения, работающих непосредственно с 2D-изображениями, через Google Earth Engine извлечены пространственные патчи трёх размеров:

- **16×16 пикселей** (160×160 м при разрешении 10 м);
- **32×32 пикселей** (320×320 м);
- **64×64 пикселей** (640×640 м).

Каждый патч содержит от 13 до 54 каналов в зависимости от конфигурации:
- **Базовая конфигурация (13 каналов)**: 12 каналов Sentinel-2 (B1–B12) + DEM;
- **Расширенная конфигурация (18 каналов)**: базовые 13 + 5 спектральных индексов (NDVI, BSI, NDSI, NDWI, RECI);
- **Мультисезонная конфигурация (54 канала)**: оптические каналы × 3 сезона (весна, лето, осень) + 5 индексов × 3 сезона + VV, VH (SAR) + DEM.

Общее количество извлечённых патчей составило 1071 на каждый размер. Патчи сохранены в формате NumPy (.npy) с формой `[C, H, W]` (channels-first).

![Рис. 1. Примеры спутниковых патчей (RGB-композит)](ML/results/qa/patches_rgb_sample.png)

*Рис. 1. Примеры спутниковых патчей для 6 полей: RGB-композит (B4, B3, B2) из каналов Sentinel-2.*

![Рис. 2. Примеры спутниковых патчей (NDVI)](ML/results/qa/patches_ndvi_sample.png)

*Рис. 2. Визуализация NDVI-канала для тех же полей. Градации зелёного цвета отражают вегетационную активность.*

### 3.4 Стратегия кросс-валидации

Пространственная автокорреляция почвенных свойств — фундаментальное свойство, описываемое первым законом географии Тоблера: образцы, расположенные ближе друг к другу, более схожи, чем удалённые (Roberts et al., 2017). В контексте машинного обучения это означает, что при случайном разбиении на train/test образцы с одного поля (или пространственно близких полей) попадают и в обучающую, и в тестовую выборки, создавая эффект утечки данных (data leakage) и приводя к оптимистично завышенным оценкам качества (Wadoux et al., 2021; Meyer & Pebesma, 2021).

Для предотвращения этого эффекта применена стратегия **Spatial Leave-One-Field-Out Cross-Validation (LOFO-CV)**:

1. Набор данных группируется по 186 полевым участкам (`field_name`);
2. На каждой из 186 итераций один участок полностью выделяется в тестовую выборку (от 1 до 8 образцов);
3. Все остальные 185 участков формируют обучающую выборку;
4. Модель обучается заново на каждой итерации;
5. Финальные метрики рассчитываются по агрегированным out-of-fold (OOF) предсказаниям всех 1085 образцов.

Данная стратегия является более строгой, чем случайное разбиение (random split) или GroupKFold с фиксированным числом складок, поскольку полностью изолирует пространственные единицы и даёт наиболее реалистичные оценки качества для предсказания на **новых, ранее не обследованных** участках — практически наиболее релевантном сценарии для цифрового почвенного картирования.

Для моделей глубокого обучения дополнительно выделялось 20% обучающих полей (выбранных случайно, но целиком, без разрыва полей) в качестве валидационного набора для механизма раннего останова (early stopping). Это предотвращает пространственную утечку как на этапе оценки модели (test), так и на этапе выбора момента остановки (validation).

**Предобработка признаков.** Нормализация (StandardScaler: z = (x − μ) / σ, где μ и σ вычислены **только на обучающей выборке** каждого фолда) применялась для всех DL-моделей, SVR, KNN и линейных моделей (LR, Ridge, SGD). Для древесных ансамблей (RF, XGBoost, CatBoost, GBDT, ET, CART) масштабирование не применялось, поскольку деревья решений инвариантны к монотонным преобразованиям признаков (Breiman, 2001). Выбросы в целевых переменных не удалялись, чтобы сохранить полный диапазон вариабельности; вместо этого для DL-моделей использована HuberLoss, устойчивая к отдельным экстремальным значениям.

### 3.5 Традиционные модели машинного обучения

Сравнение проведено для 11 классических ML-алгоритмов:

**Таблица 5.** Конфигурации традиционных ML-моделей

| Модель | Библиотека | Ключевые гиперпараметры |
|---|---|---|
| Random Forest (RF) | scikit-learn | n_estimators=500, max_features=sqrt, min_samples_leaf=3 |
| Extra Trees (ET) | scikit-learn | Аналогично RF, с рандомизированными порогами |
| XGBoost | xgboost | Градиентный бустинг на деревьях решений |
| CatBoost | catboost | Gradient boosting с поддержкой категориальных признаков |
| GBDT | scikit-learn | GradientBoostingRegressor |
| CART | scikit-learn | DecisionTreeRegressor |
| KNN | scikit-learn | K-ближайших соседей |
| Linear Regression (LR) | scikit-learn | Обычный МНК |
| Ridge | scikit-learn | L2-регуляризация |
| SGD | scikit-learn | Стохастический градиентный спуск |
| SVR | scikit-learn | Support Vector Regression (RBF kernel) |

Все модели обучены на 15 отобранных признаках для каждого целевого свойства с использованием полного LOFO-CV (186 фолдов). Для обеспечения воспроизводимости зафиксирован `random_state=42` во всех стохастических алгоритмах.

Дополнительно для подмножества моделей (RF, XGBoost, GBDT, ET, KNN, SVR) проведена настройка гиперпараметров через **GridSearchCV** с 5-кратной группированной кросс-валидацией внутри обучающего набора каждого LOFO-фолда (nested cross-validation). Пространство поиска:

- **RF**: `n_estimators` ∈ {200, 500, 1000}, `max_features` ∈ {sqrt, 0.5, 0.8}, `min_samples_leaf` ∈ {1, 3, 5};
- **XGBoost**: `n_estimators` ∈ {100, 300, 500}, `max_depth` ∈ {3, 5, 7}, `learning_rate` ∈ {0.01, 0.05, 0.1}, `subsample` ∈ {0.7, 0.9};
- **GBDT**: `n_estimators` ∈ {100, 300}, `max_depth` ∈ {3, 5}, `learning_rate` ∈ {0.01, 0.05, 0.1};
- **KNN**: `n_neighbors` ∈ {3, 5, 7, 10, 15}, `weights` ∈ {uniform, distance};
- **SVR**: `C` ∈ {0.1, 1, 10, 100}, `gamma` ∈ {scale, auto, 0.01, 0.1}.

### 3.6 Архитектуры глубокого обучения

#### 3.6.1 1D CNN на табличных признаках

Для моделирования нелинейных взаимодействий между 15 табличными признаками разработана одномерная свёрточная нейронная сеть (SoilCNN1D):

```
Вход: (batch, 1, 15)
  → Conv1d(1→16, kernel=3, padding=1) → BatchNorm1d(16) → ReLU → MaxPool1d(2)
    Выход: (batch, 16, 7)
  → Conv1d(16→32, kernel=3, padding=1) → BatchNorm1d(32) → ReLU → MaxPool1d(2)
    Выход: (batch, 32, 3)
  → Dropout(0.3) → Flatten
    Выход: (batch, 96)
  → Linear(96→32) → ReLU → Linear(32→1)
```

**Гиперпараметры**: 300 эпох, batch_size=32, оптимизатор Adam (lr=0.001, weight_decay=1e-4), ранний останов с patience=30 по MSE на валидационной выборке.

Валидационная выборка для раннего останова формировалась из 20% обучающих полей (отдельная от тестового поля LOFO-CV), что предотвращает пространственную утечку на этапе выбора модели.

#### 3.6.2 ResNet-18 на спутниковых патчах

Для обработки двумерных спутниковых патчей адаптирована архитектура ResNet-18:

- **Входной слой**: заменён `Conv2d(3→64)` на `Conv2d(18→64)` для 18-канальных патчей (12 S2 + 5 индексов + DEM);
- **Выходной слой**: `nn.Sequential(Dropout(0.3) → Linear(512→128) → ReLU → Dropout(0.15) → Linear(128→1))`;
- Сеть обучена **с нуля** (weights=None), поскольку спутниковые данные принципиально отличаются от RGB-изображений ImageNet;
- **Аугментация** обучающих данных: случайные горизонтальные/вертикальные отражения и вращения на 0°/90°/180°/270°.

**Гиперпараметры**: 60 эпох, batch_size=32, AdamW (lr=1e-4, weight_decay=1e-5), ReduceLROnPlateau (factor=0.5, patience=3), ранний останов (patience=10).

Нормализация патчей выполнялась глобально по каждому каналу (Z-score на уровне всего датасета).

#### 3.6.3 ConvNeXt на мультисезонных композитах

Для максимального использования мультисезонной спектральной информации разработана архитектура MultiSpectralConvNeXt, основанная на следующих принципах:

**Squeeze-and-Excitation (SE) блок** — адаптивное взвешивание каналов:
```
Вход: x [B, C, H, W]
  → AdaptiveAvgPool2d(1) → Conv2d(C→C/4, 1×1) → ReLU → Conv2d(C/4→C, 1×1) → Sigmoid
  → x × scale
```

**ConvNeXt блок** — современная альтернатива ResNet:
```
Вход: x [B, C, H, W]
  → DepthwiseConv2d(C→C, kernel=7, groups=C) → LayerNorm(C)
  → Linear(C→4C) → GELU → Linear(4C→C) → SE(C)
  → Residual: x + output
```

**Полная архитектура**:
```
Stem: Conv2d(in_ch→128, 1×1) → BN → GELU
Stage 1: ConvNeXtBlock(128) × 2 → AvgPool(2)
Stage 2: Conv2d(128→256) → ConvNeXtBlock(256) × 2 → AvgPool(2)
Stage 3: Conv2d(256→512) → ConvNeXtBlock(512) × 1
Head: AdaptiveAvgPool(1) → Dropout(0.4) → Linear(512→128) → GELU → Linear(128→1)
```

**Входные данные**: 54-канальные мультисезонные патчи 32×32:
- Каналы 0–11: оптические S2 (весна), 17–28: (лето), 34–45: (осень);
- Каналы 12–16: NDVI/BSI/NDSI/NDWI/RECI (весна), 29–33: (лето), 46–50: (осень);
- Каналы 51–52: SAR VV/VH, канал 53: DEM.

**Гиперпараметры**: до 300 эпох, batch_size=32, AdamW (lr=5e-4, weight_decay=1e-4), HuberLoss (устойчива к выбросам), ранний останов (patience=20), mixed precision (AMP) для ускорения обучения на GPU.

В ablation study базовые 39 каналов (оптика × 3 сезона + SAR + DEM) последовательно дополнялись инженерными индексами (по 3 канала на индекс: весна/лето/осень).

### 3.7 Метрики оценки

Для оценки моделей использованы следующие метрики:

- **Spearman ρ** (основная) — ранговый коэффициент корреляции, устойчивый к ненормальности распределений;
- **RMSE** — среднеквадратическая ошибка;
- **MAE** — средняя абсолютная ошибка;
- **R²** — коэффициент детерминации.

Выбор Spearman ρ в качестве основной метрики обусловлен подтверждённой ненормальностью распределений всех целевых свойств (Таблица 2).

---

## 4. Результаты

### 4.1 Сравнение традиционных ML-моделей

Результаты всех 12 моделей, обученных на 15 табличных признаках с LOFO-CV, представлены в Таблице 6 и на Рис. 3.

**Таблица 6.** Сравнительные метрики моделей (Spearman ρ) по Spatial LOFO-CV

| Модель | pH | SOC | NO₃ | P₂O₅ | K₂O | S |
|---|---|---|---|---|---|---|
| **GBDT** | **0.857** | 0.657 | 0.707 | 0.563 | **0.616** | **0.536** |
| XGBoost | 0.846 | 0.543 | 0.694 | 0.575 | 0.560 | 0.495 |
| CatBoost | 0.826 | 0.646 | 0.736 | **0.600** | 0.482 | 0.478 |
| **RF** | 0.798 | **0.731** | 0.775 | 0.595 | **0.624** | 0.518 |
| **ET** | 0.771 | **0.735** | **0.768** | **0.611** | 0.615 | 0.494 |
| KNN | 0.642 | 0.689 | 0.753 | 0.555 | 0.517 | 0.393 |
| SVR | 0.714 | 0.658 | 0.691 | 0.600 | 0.435 | 0.400 |
| LR | 0.747 | 0.616 | 0.382 | 0.496 | 0.471 | 0.315 |
| Ridge | 0.747 | 0.617 | 0.383 | 0.497 | 0.470 | 0.316 |
| SGD | 0.747 | 0.627 | 0.394 | 0.509 | 0.468 | 0.323 |
| CART | 0.537 | 0.234 | 0.573 | 0.481 | 0.516 | 0.411 |
| ResNet-18 | 0.709 | 0.560 | 0.599 | 0.567 | 0.470 | 0.425 |

Жирным выделены лучшие значения. Ансамблевые модели (GBDT, RF, ET, CatBoost) стабильно превосходят линейные (LR, Ridge, SGD) и единичные деревья (CART). Лучший общий результат для pH достигнут GBDT (ρ = 0.857, R² = 0.841), для SOC — ET (ρ = 0.735), для NO₃ — RF (ρ = 0.775).

**Таблица 7.** Полные метрики для топ-4 моделей (Spearman ρ / RMSE / R²)

| Свойство | GBDT | RF | ET | CatBoost |
|---|---|---|---|---|
| pH | 0.857 / 0.261 / 0.841 | 0.798 / 0.298 / 0.794 | 0.771 / 0.323 / 0.758 | 0.826 / 0.289 / 0.806 |
| SOC | 0.657 / 0.442 / 0.349 | 0.731 / 0.385 / 0.506 | 0.735 / 0.386 / 0.504 | 0.646 / 0.407 / 0.448 |
| NO₃ | 0.707 / 6.069 / 0.409 | 0.775 / 5.002 / 0.598 | 0.768 / 4.832 / 0.625 | 0.736 / 5.681 / 0.482 |
| P₂O₅ | 0.563 / 16.30 / 0.355 | 0.595 / 15.36 / 0.428 | 0.611 / 15.38 / 0.426 | 0.600 / 16.77 / 0.318 |
| K₂O | 0.616 / 121.95 / 0.464 | 0.624 / 121.36 / 0.469 | 0.615 / 125.72 / 0.430 | 0.482 / 138.02 / 0.314 |
| S | 0.536 / 4.00 / 0.725 | 0.518 / 3.57 / 0.780 | 0.494 / 3.67 / 0.767 | 0.478 / 3.84 / 0.746 |

![Рис. 3. Сравнение моделей по Spearman ρ](ML/results/all_models_comparison_rho.png)

*Рис. 3. Сводная диаграмма Spearman ρ для всех моделей и целевых свойств при Spatial LOFO-CV.*

![Рис. 4. Сравнение моделей по R²](ML/results/unified_comparison_r2.png)

*Рис. 4. Сравнение моделей по коэффициенту детерминации R².*

### 4.2 Детальный анализ Random Forest

Random Forest продемонстрировал стабильно высокие результаты по всем свойствам, являясь лучшей моделью для SOC и K₂O и второй по качеству для pH и NO₃.

![Рис. 5. Scatter plots RF OOF-предсказаний для всех свойств](ML/results/rf_oof_scatter_grid.png)

*Рис. 5. Диаграммы рассеяния истинных и предсказанных значений (OOF) для Random Forest по всем шести целевым свойствам.*

Анализ важности признаков (MDI, усреднённая по всем фолдам LOFO-CV) показал, что ключевыми предикторами являются:

- **Для pH**: спектральный индекс GNDVI весной, текстурная энтропия NIR осенью, временной тренд MSI;
- **Для SOC**: стандартное отклонение MSI, высота рельефа (DEM), осадки вегетационного периода;
- **Для NO₃**: содержание Mg, текстура IDM (NIR, лето), GNDVI (L8, весна).

![Рис. 6. Важность признаков RF для pH](ML/results/rf/ph_importance.png)

*Рис. 6. Топ-15 признаков по важности (MDI) для предсказания pH.*

![Рис. 7. Важность признаков RF для SOC](ML/results/rf/soc_importance.png)

*Рис. 7. Топ-15 признаков по важности (MDI) для предсказания SOC.*

![Рис. 8. Важность признаков RF для NO₃](ML/results/rf/no3_importance.png)

*Рис. 8. Топ-15 признаков по важности (MDI) для предсказания NO₃.*

![Рис. 9. RF CV Summary](math_statistics/output/rf/rf_cv_summary.png)

*Рис. 9. Сводные результаты кросс-валидации Random Forest по всем свойствам.*

### 4.3 Результаты ResNet-18 на спутниковых патчах

ResNet-18, обученный на 18-канальных патчах 64×64 с LOFO-CV, показал результаты, уступающие табличным ансамблевым моделям для большинства свойств (Таблица 6). Наибольший Spearman ρ достигнут для pH (0.709), наименьший — для K₂O (0.470) и S (0.425).

**Таблица 8.** Метрики ResNet-18 (Spatial LOFO-CV)

| Свойство | Spearman ρ | RMSE | MAE | R² |
|---|---|---|---|---|
| pH | 0.709 | 0.389 | 0.276 | 0.649 |
| SOC | 0.560 | 0.493 | 0.339 | 0.196 |
| NO₃ | 0.599 | 6.454 | 4.025 | 0.331 |
| P₂O₅ | 0.567 | 15.098 | 9.189 | 0.433 |
| K₂O | 0.470 | 145.779 | 111.850 | 0.241 |
| S | 0.425 | 3.734 | 2.523 | 0.762 |

Важно отметить, что для P₂O₅ ResNet достиг R² = 0.433 — значение, сопоставимое с лучшими табличными моделями, что свидетельствует о наличии пространственной информации в патчах, полезной для предсказания фосфора.

![Рис. 10. ResNet scatter — pH](ML/results/resnet/ph_resnet_scatter.png)

*Рис. 10. Scatter plot OOF-предсказаний ResNet-18 для pH.*

![Рис. 11. ResNet scatter — SOC](ML/results/resnet/soc_resnet_scatter.png)

*Рис. 11. Scatter plot OOF-предсказаний ResNet-18 для SOC.*

### 4.4 Ablation study: размер патча и спектральные индексы

Проведено систематическое исследование влияния двух факторов на качество CNN:
1. **Размер патча**: 16×16, 32×32, 64×64 пикселей;
2. **Число дополнительных спектральных индексов**: от 0 (только 13 базовых каналов) до 5 (NDVI, BSI, NDSI, NDWI, RECI).

**Таблица 9.** Ablation study: лучшие конфигурации CNN по R² (пространственный split)

| Свойство | Лучший патч | Лучшая конфигурация | R² | RMSE |
|---|---|---|---|---|
| pH | 32×32 | 13 bands + 1 index (NDVI) | **0.878** | 0.213 |
| HU (SOC proxy) | 32×32 | 13 bands + 1 index (NDVI) | **0.641** | 0.429 |
| NO₃ | 32×32 | 13 bands + 3 indices | **0.470** | 4.843 |
| K₂O | 64×64 | 13 bands + 3 indices | **0.382** | 118.66 |
| P₂O₅ | 64×64 | 13 bands + 0 indices | **0.396** | 7.346 |
| S | 16×16 | 13 bands + 4 indices | **0.012** | 2.929 |

Ключевые наблюдения:
- **Оптимальный размер патча — 32×32**: обеспечивает баланс между пространственным контекстом и соотношением сигнал/шум;
- **NDVI** — наиболее полезный дополнительный индекс, повышающий R² для pH с 0.807 до 0.878 при патче 32×32;
- **Для S** ни одна конфигурация CNN не достигла положительного R², что свидетельствует о сложности предсказания серы из спутниковых данных.

![Рис. 12. Ablation матрица CNN](ML/results/cnn_ablation_matrix.png)

*Рис. 12. Матрица ablation study: R² для комбинаций размеров патчей и числа спектральных индексов.*

![Рис. 13. Детальные столбчатые диаграммы ablation](ML/results/detailed_ablation_bars.png)

*Рис. 13. Детальное сравнение R² по конфигурациям для каждого свойства.*

### 4.5 Мультисезонный ConvNeXt

Архитектура ConvNeXt обучена на 54-канальных мультисезонных композитах (32×32) с постепенным добавлением инженерных индексов.

**Таблица 10.** Результаты мультисезонного ConvNeXt (пространственный split)

| Свойство | Лучшая конфигурация | R² | RMSE |
|---|---|---|---|
| pH | Base 39Ch + 5 indices | **0.772** | 0.292 |
| HU | Base 39Ch + 1 index | **0.481** | 0.516 |
| NO₃ | Base 39Ch + 5 indices | **0.575** | 4.337 |
| K₂O | Base 39Ch + 0 indices | **0.230** | 132.44 |
| P₂O₅ | Base 39Ch + 4 indices | −0.221 | 10.443 |
| S | Base 39Ch + 5 indices | **0.037** | 2.892 |

Мультисезонный ConvNeXt показал наилучший результат для NO₃ среди всех CNN-архитектур (R² = 0.575), что подтверждает гипотезу о временно́й динамике нитратов, отражаемой в сезонных спутниковых композитах. Для pH результат (R² = 0.772) уступает односезонному CNN (0.878), вероятно из-за разбавления информативного весеннего сигнала неинформативными осенними каналами.

![Рис. 14. Ablation матрица мультисезонного CNN](ML/results/multiseason_ablation_matrix.png)

*Рис. 14. Матрица R² для мультисезонного ConvNeXt при последовательном добавлении спектральных индексов.*

![Рис. 15. Сравнение мультисезонного CNN с ML](ML/results/multiseason_vs_ml_comparison.png)

*Рис. 15. Сравнение мультисезонного ConvNeXt с традиционными ML-моделями.*

### 4.6 ConvNeXt ablation: односезонный vs мультисезонный

Для отдельной оценки вклада мультисезонных данных проведено дополнительное сравнение конфигураций ConvNeXt.

**Таблица 11.** ConvNeXt ablation (односезонный, пространственный split)

| Свойство | Лучшая конфигурация | R² | RMSE |
|---|---|---|---|
| pH | Base 39Ch + 0 indices | **0.798** | 0.275 |
| HU | Base 39Ch + 5 indices | **0.501** | 0.507 |
| NO₃ | Base 39Ch + 3 indices | **0.422** | 5.056 |
| K₂O | Base 39Ch + 3 indices | **0.204** | 134.72 |
| P₂O₅ | Base 39Ch + 5 indices | **0.223** | 8.332 |
| S | Base 39Ch + 0 indices | −0.113 | 3.109 |

Сравнение показывает, что мультисезонные данные улучшают предсказание NO₃ (R²: 0.422 → 0.575, +36%) и S (−0.113 → 0.037), но ухудшают pH (0.798 → 0.772), что указывает на необходимость дифференцированного подхода к выбору временного окна для каждого почвенного свойства.

### 4.7 Настроенные ML-модели на пространственных признаках

Для проверки эффективности традиционных ML-моделей на пространственном split (train/val/test по полям) проведена настройка гиперпараметров через GridSearch.

**Таблица 12.** Лучшие настроенные ML-модели (пространственный split)

| Свойство | Лучшая модель | R² | RMSE |
|---|---|---|---|
| pH | XGBoost | **0.892** | 0.201 |
| HU | KNN | **0.542** | 0.485 |
| NO₃ | ET | **0.676** | 3.784 |
| K₂O | GBDT | **0.367** | 120.13 |
| P₂O₅ | GBDT | **0.393** | 7.363 |
| S | ET | **0.026** | 2.907 |

![Рис. 16. Сравнение настроенных моделей](ML/results/tuned_ml_all_comparison.png)

*Рис. 16. Сравнение R² для настроенных ML-моделей на пространственном split.*

![Рис. 17. Итоговое сравнение R² (настроенные модели)](ML/results/final_comparison_r2_tuned.png)

*Рис. 17. Итоговая сводная диаграмма R² для всех настроенных моделей.*

### 4.8 Анализ важности признаков (Feature Importance)

Анализ важности признаков на основе Random Forest из статистического модуля позволяет выявить наиболее информативные предикторы для каждого свойства.

![Рис. 18. Важность признаков для pH (RF, статистический модуль)](math_statistics/output/rf/rf_importance_ph.png)

*Рис. 18. Важность признаков RF для pH (статистический модуль).*

![Рис. 19. Важность признаков для SOC](math_statistics/output/rf/rf_importance_hu.png)

*Рис. 19. Важность признаков RF для гумуса (SOC proxy).*

![Рис. 20. Важность признаков для NO₃](math_statistics/output/rf/rf_importance_no3.png)

*Рис. 20. Важность признаков RF для NO₃.*

![Рис. 21. Важность признаков для K₂O](math_statistics/output/rf/rf_importance_k.png)

*Рис. 21. Важность признаков RF для K₂O.*

![Рис. 22. Важность признаков для P₂O₅](math_statistics/output/rf/rf_importance_p.png)

*Рис. 22. Важность признаков RF для P₂O₅.*

![Рис. 23. Важность признаков для S](math_statistics/output/rf/rf_importance_s.png)

*Рис. 23. Важность признаков RF для S.*

### 4.9 Scatter plots: RF (статистический модуль)

![Рис. 24. RF Scatter — pH](math_statistics/output/rf/rf_scatter_ph.png)

*Рис. 24. Scatter plot RF-предсказаний vs истинных значений pH.*

![Рис. 25. RF Scatter — SOC](math_statistics/output/rf/rf_scatter_hu.png)

*Рис. 25. Scatter plot RF-предсказаний vs истинных значений гумуса.*

![Рис. 26. RF Scatter — NO₃](math_statistics/output/rf/rf_scatter_no3.png)

*Рис. 26. Scatter plot RF-предсказаний vs истинных значений NO₃.*

---

## 5. Обсуждение

### 5.1 Ансамблевые методы vs линейные модели

Результаты однозначно демонстрируют превосходство ансамблевых древесных методов над линейными моделями, что согласуется с мета-анализом Wadoux et al. (2020), отмечающим, что RF и градиентный бустинг доминируют в задачах DSM. GBDT, RF, ET и CatBoost стабильно занимают первые позиции по Spearman ρ и R² для всех шести целевых свойств. Линейные модели (LR, Ridge, SGD) показывают сопоставимые результаты только для pH (ρ ≈ 0.747), где связь с предикторами наиболее монотонна, но катастрофически проигрывают для NO₃ (ρ < 0.40 vs > 0.77 у RF) из-за нелинейной природы пространственного распределения нитратов, определяемого комплексом факторов (микробиологическая активность, влажность, temperature regime, история внесения удобрений).

Полученные значения Spearman ρ для pH (0.857) и SOC (0.735) сопоставимы или превосходят результаты аналогичных исследований: Castaldi et al. (2019) достигли R² = 0.68 для SOC в Бельгии при использовании только данных Sentinel-2 (N = 137); Vaudour et al. (2019) получили R² = 0.72 для pH в умеренных агроэкосистемах Франции (N = 118). Преимущество нашего пайплайна обусловлено, вероятно, существенно бо́льшим размером обучающей выборки (N = 1085) и мультимодальностью признакового пространства (6 источников данных vs 1–2 в цитированных работах).

CART, несмотря на древесную природу, показывает наихудшие результаты среди всех моделей (SOC: ρ = 0.234), что подтверждает критическую роль ансамблирования — bagging в RF/ET снижает дисперсию, а boosting в GBDT/XGBoost/CatBoost последовательно корректирует остатки предыдущих моделей (Breiman, 2001; Friedman, 2001). Разница между CART и RF достигает 0.50 по Spearman ρ для SOC, что является одной из наибольших зафиксированных в литературе разниц для почвенных задач.

Интересно отметить специализацию различных ансамблей: GBDT лидирует для pH (свойство с наименьшим CV = 9.4%), тогда как RF и ET доминируют для свойств с высокой вариабельностью (SOC, NO₃, P₂O₅). Это объясняется тем, что бустинг оптимален при стабильных, квазилинейных зависимостях, тогда как bagging лучше справляется с шумными данными за счёт усреднения (Hastie et al., 2009).

### 5.2 Глубокое обучение на спутниковых патчах

ResNet-18 на 2D патчах показал смешанные результаты: для pH (ρ = 0.709) и P₂O₅ (R² = 0.433) результаты сопоставимы с некоторыми табличными моделями, но для SOC (ρ = 0.560), NO₃ (ρ = 0.599) и K₂O (ρ = 0.470) существенно уступают RF и ET. Эти результаты согласуются с наблюдениями Padarian et al. (2019), которые отмечали, что DL-модели начинают устойчиво превосходить RF только при размерах обучающей выборки >5000 образцов.

Разрыв между ResNet и табличными ансамблями можно объяснить следующими факторами:

1. **Малый размер датасета** (1071 патч) — недостаточно для обучения глубокой сети с >11M параметров. Отношение числа параметров к числу обучающих примеров составляет ~10000:1, что на два порядка превышает рекомендуемое значение (Behrens et al., 2018). Регуляризация (dropout, weight decay) лишь частично компенсирует этот дефицит;
2. **Отсутствие предобучения** — в отличие от RGB-задач компьютерного зрения, для мультиспектральных спутниковых данных не существует готовых крупномасштабных предобученных весов. Инициализация «с нуля» требует существенно бо́льших объёмов данных для конвергенции к качественному минимуму функции потерь;
3. **Агрегация пространственного контекста** — GlobalAveragePooling в ResNet усредняет информацию по пространственным измерениям, что может терять информативные локальные паттерны (границы полей, микрорельеф, гетерогенность растительного покрова). Табличные признаки (GLCM-текстуры, PCA-компоненты, межсезонные дельты) уже кодируют эту информацию в компактной и интерпретируемой форме;
4. **Пространственная неоднородность** — стандартные CNN предполагают локальную стационарность, тогда как спутниковый патч 640×640 м может охватывать несколько элементарных ландшафтов с различными почвенными свойствами.

Тем не менее, для P₂O₅ ResNet достиг R² = 0.433 — значение, сопоставимое с лучшими табличными моделями (RF: R² = 0.428). Это свидетельствует о наличии пространственной информации в изображениях (текстура поверхности, мозаичность растительного покрова), полезной для предсказания фосфора, которая не полностью извлекается при табличном инженерировании признаков.

### 5.3 Оптимальный размер патча и роль NDVI

Ablation study выявило, что **32×32 пикселей** (320×320 м при разрешении 10 м) является оптимальным размером патча для большинства свойств. Этот результат согласуется с агрономическим масштабом элементарного участка обследования (20–50 га ≈ 450–700 м), при котором патч целиком попадает в пределы одного функционального поля. Патч 16×16 (160 м) содержит недостаточно пространственного контекста для выявления текстурных паттернов и микроландшафтных закономерностей. Патч 64×64 (640 м) включает слишком много шума от соседних полей, дорог, лесополос и иных ландшафтных элементов, размывая целевой сигнал.

Добавление **NDVI как единственного дополнительного индекса** к 13 базовым каналам повышает R² для pH с 0.807 до 0.878 (+8.8%) при патче 32×32. Это объясняется тем, что NDVI является наиболее устойчивым интегральным показателем вегетационной активности, тесно коррелирующим с содержанием органического вещества и pH через механизм «лучшие почвы → лучший рост → выше NDVI» (Tucker, 1979). Однако дальнейшее добавление индексов (BSI, NDSI, NDWI, RECI) не всегда улучшает результат, а иногда даже ухудшает его (для pH при 5 индексах R² падает до 0.539). Этот эффект объясняется мультиколлинеарностью: корреляция Пирсона между NDVI и GNDVI достигает r = 0.96, между NDVI и RECI — r = 0.91, что при ограниченном размере выборки приводит к переобучению и росту дисперсии предсказаний. Аналогичный эффект «проклятия размерности каналов» наблюдался в работах по гиперспектральному дистанционному зондированию (Hughes, 1968).

Для S ни одна конфигурация CNN не достигла положительного R² (лучший: 0.012), что свидетельствует о фундаментальном ограничении: подвижная сера не имеет прямого спектрального отклика в диапазонах Sentinel-2/Landsat-8 и её распределение определяется преимущественно антропогенными факторами (внесение серосодержащих удобрений, атмосферные выпадения).

### 5.4 Мультисезонные данные

ConvNeXt на 54-канальных мультисезонных композитах показал наибольшее преимущество для NO₃ (R² = 0.575 vs 0.470 у односезонного CNN, +22%). Это согласуется с агрономической логикой: содержание нитратов существенно варьирует в течение вегетационного периода вследствие процессов минерализации органического вещества весной, интенсивного выноса растениями летом, осеннего накопления за счёт деструкции послеуборочных остатков и продолжающейся нитрификации. Временна́я динамика NDVI и других вегетационных индексов опосредованно отражает эти процессы: ускоренное весеннее «зеленение» и более длительное сохранение зелёной биомассы характерны для полей с высоким содержанием доступного азота. Аналогичную связь между мультитемпоральными данными и нитратами отмечали Žížala et al. (2022) для территории Чехии.

Для pH, напротив, мультисезонные данные не дали улучшения (0.772 vs 0.798 у односезонного), что объяснимо высокой временной стабильностью pH в течение вегетационного периода: буферная ёмкость карбонатных почв Северного Казахстана препятствует значимым сезонным колебаниям. В этом случае дополнительные сезонные каналы вносят преимущественно шум, снижая отношение сигнал/шум.

Добавление Squeeze-and-Excitation (SE) блоков в ConvNeXt обеспечило адаптивное взвешивание каналов, что теоретически должно было позволить сети автоматически подавлять неинформативные каналы. Однако при 54 входных каналах и 1071 обучающих примерах SE-блоки, по-видимому, не имеют достаточного обучающего сигнала для выявления оптимальных весов. Это подтверждает результат: для большинства свойств мультисезонный ConvNeXt уступает табличным моделям, где отбор информативных признаков выполнен эксплицитно через MDI-ранжирование.

### 5.5 Значение пространственной кросс-валидации

Применение Spatial LOFO-CV существенно снижает оценки качества по сравнению с random split. Для RF (pH) при пространственном split на выделенные train/val/test по полям R² = 0.896 (Таблица 12), тогда как при LOFO-CV R² = 0.794. Разница в **10.2 процентных пункта** объясняется пространственной автокорреляцией: при случайном разбиении образцы с одного поля попадают и в train, и в test, создавая иллюзию высокого качества. Масштаб этого завышения (10–15%) согласуется с оценками Roberts et al. (2017), которые зафиксировали аналогичные или бо́льшие расхождения в экологических задачах, и Wadoux et al. (2021), показавшими систематическое завышение R² на 0.05–0.30 при random split для SOC.

LOFO-CV даёт наиболее реалистичную оценку генерализующей способности модели для предсказания на **новых, ранее не обследованных** участках — единственный практически релевантный сценарий для масштабирования цифрового почвенного картирования. Рекомендуем исследователям в области DSM по умолчанию использовать пространственные стратегии валидации и явно указывать тип разбиения при публикации результатов (Meyer & Pebesma, 2021).

### 5.6 Сложные для предсказания свойства

Три свойства — P₂O₅ (лучший ρ = 0.611), K₂O (ρ = 0.624) и S (ρ = 0.536) — предсказываются существенно хуже, чем pH и NO₃. Анализ причин:

- **Высокая пространственная вариабельность** (CV > 78% для P₂O₅ и S) означает, что даже пространственно близкие образцы могут различаться в разы. Семивариограммный анализ (этап s10 пайплайна) показал, что значения sill для P₂O₅ и S достигаются на дистанциях <300 м — за пределами разрешающей способности большинства спутниковых источников;
- **Антропогенное влияние**: содержание P₂O₅ и K₂O в значительной степени определяется историей внесения удобрений, которая пространственно гетерогенна на уровне отдельных полей и хозяйств. Эта информация принципиально не может быть извлечена из спутниковых данных без привлечения агрономических баз данных;
- **Слабая корреляция со спектральными характеристиками**: в отличие от SOC (прямое влияние на отражающую способность почвы в видимом диапазоне) и NO₃ (опосредованная связь через вегетационную биомассу), P₂O₅, K₂O и S не имеют прямых спектральных сигнатур в диапазонах 400–2500 нм. Их влияние на растительный покров проявляется лишь в случаях острого дефицита, что редко для богатых калием чернозёмных почв (среднее K₂O = 650 мг/кг, что соответствует высокой обеспеченности).

Для S ни одна CNN-конфигурация не достигла положительного R² (лучший: 0.037 у мультисезонного ConvNeXt), что указывает на принципиальную невозможность предсказания подвижной серы из мультиспектральных спутниковых данных на данном пространственном разрешении. Аналогичные результаты получены Vaudour et al. (2019), которые также исключили S из анализа из-за отсутствия предиктивной связи. Перспективными направлениями для улучшения предсказания серы могут быть привлечение данных гамма-спектрометрической съёмки и электрической томографии.

### 5.7 Интерпретируемость и физический смысл ключевых предикторов

Анализ важности признаков (Рис. 6–8, 18–23) позволяет установить физически обоснованные связи между спутниковыми данными и почвенными свойствами:

- **GNDVI весной** — ведущий предиктор pH. GNDVI = (NIR − Green)/(NIR + Green) чувствителен к содержанию хлорофилла, которое положительно коррелирует с доступностью элементов питания, определяемой pH. Весенний период оптимален, так как растительный покров ещё не достиг полного смыкания, и спектральный сигнал содержит информацию как о почве, так и о ранней вегетации;
- **Временна́я изменчивость MSI** (ts_s2_MSI_std) — ведущий предиктор SOC. Moisture Stress Index (MSI = SWIR/NIR) отражает водный стресс; его высокая вариабельность по сезонам характерна для почв с низким SOC, обладающих худшей водоудерживающей способностью и подверженных резким колебаниям влажности;
- **DEM** — значимый предиктор SOC и K₂O. Высота позиции ландшафта определяет баланс аккумуляции/выноса мелкозёма и органического вещества: западины и нижние части склонов накапливают более богатый гумусом материал за счёт делювиального перемещения (McBratney et al., 2003).

### 5.8 Практические рекомендации

На основании полученных результатов формулируются следующие практические рекомендации для оперативного мониторинга агрохимического состояния почв:

1. **Для pH и NO₃** (ρ > 0.77): модели RF/GBDT на 15 табличных признаках готовы к пилотному внедрению. Прогнозные карты могут использоваться для зонирования полей по потребности в известковании (pH) и дифференцированного внесения азотных удобрений (NO₃);
2. **Для SOC** (ρ = 0.735): качество достаточно для мониторинга трендов (обогащение/деградация гумуса) на уровне хозяйств, но недостаточно для замены лабораторного анализа;
3. **Для P₂O₅ и K₂O** (ρ ≈ 0.60): прогнозы могут использоваться для предварительного скрининга и оптимизации схемы пробоотбора (увеличение плотности проб в зонах высокой предсказанной вариабельности);
4. **Для S** (ρ = 0.536): спутниковые предсказания не рекомендуются; необходимы альтернативные источники данных.

### 5.9 Ограничения исследования

1. **Размер датасета**: 1085 образцов — достаточно для табличных ML-моделей (эмпирическое правило: >10 образцов на признак; при 15 признаках — 150 образцов), но существенно ограничивает потенциал глубокого обучения. Современные work-in-progress датасеты для DSM (EU LUCAS: >20000 образцов) демонстрируют существенное преимущество DL при увеличении объёма данных;
2. **Два года наблюдений** (2022–2023): межгодовая вариабельность не полностью охвачена. Климатические аномалии конкретных лет (засуха 2022 г.) могут смещать модели;
3. **Отсутствие гиперспектральных данных**: миссии PRISMA (Italian Space Agency) и EnMAP (German Aerospace Center) обеспечивают >200 спектральных каналов с разрешением ~30 м, что потенциально значительно улучшило бы предсказание SOC и минералогического состава, однако их покрытие исследуемого региона ограничено;
4. **Единственный регион**: результаты получены для чернозёмно-каштановой зоны Северного Казахстана и могут не переноситься напрямую на другие почвенные зоны (серые лесные, подзолистые, аллювиальные почвы) без дополнительной калибровки (domain adaptation);
5. **Стационарные SoilGrids и DEM**: не отражают межгодовые изменения, хотя используемые как предикторы. SoilGrids v2.0 основаны на данных до 2020 г. и могут не точно отражать текущее состояние;
6. **Отсутствие данных об агрономических практиках**: история севооборотов, нормы внесения удобрений, тип обработки почвы — факторы, существенно влияющие на P₂O₅, K₂O и S, — не включены в набор предикторов из-за их недоступности в пространственно-эксплицитной форме;
7. **Transfer learning**: не исследованы методы переноса знаний из RGB-предобученных моделей (ImageNet) с адаптацией входного слоя, а также self-supervised предобучение на неразмеченных спутниковых данных, что может улучшить качество DL-моделей.

---

## 6. Заключение

В данной работе представлен комплексный сравнительный анализ методов машинного и глубокого обучения для предсказания шести агрохимических свойств почв Северного Казахстана на основе мультимодальных спутниковых данных. Исследование объединяет 12-стадийное извлечение 536 признаков из 6 источников данных, строгую пространственную кросс-валидацию (LOFO-CV) и систематическую оценку 12 ML-алгоритмов и 3 DL-архитектур. Основные результаты:

1. **Ансамблевые древесные методы** (GBDT, RF, ET) обеспечивают наилучшее качество предсказания на табличных признаках: pH (ρ = 0.857, R² = 0.841), SOC (ρ = 0.735, R² = 0.504), NO₃ (ρ = 0.775, R² = 0.625). Эти результаты сопоставимы или превосходят опубликованные для аналогичных задач в других регионах мира, несмотря на использование строгой пространственной валидации.

2. **CNN на спутниковых патчах** достигают конкурентных результатов для pH (R² = 0.878 при оптимальной конфигурации 32×32 + NDVI), но уступают табличным ансамблям для микро- и макроэлементов. Выявлен оптимальный размер патча (32×32 пикселей) и показано, что добавление единственного индекса NDVI повышает R² на 8.8%, тогда как избыточное число каналов приводит к деградации качества.

3. **Мультисезонный ConvNeXt** с Squeeze-and-Excitation блоками улучшает предсказание NO₃ на 22% (R²: 0.422 → 0.575) по сравнению с односезонной конфигурацией, подтверждая ценность временнóй динамики спектральных индексов для свойств, тесно связанных с вегетационным циклом.

4. **Spatial LOFO-CV** снижает оценки R² на 10–15 процентных пунктов по сравнению с random split, что не только подтверждает наличие значительной пространственной автокорреляции, но и подчёркивает критическую необходимость пространственных стратегий валидации для получения реалистичных оценок в задачах DSM.

5. **Сера (S)** остаётся не предсказуемой из мультиспектральных спутниковых данных (R² ≤ 0.037 для CNN), что указывает на фундаментальное ограничение оптических и радарных сенсоров для данного элемента.

Разработанный пайплайн, объединяющий GEE-извлечение, пространственную кросс-валидацию и мультимодельное сравнение, может служить методологической основой для оперативного мониторинга почвенного плодородия в аридных и полуаридных регионах Центральной Азии. Практическое внедрение рекомендуется начать с RF/GBDT моделей для pH и NO₃ — свойств с наивысшей точностью предсказания и наибольшей агрономической значимостью для оптимизации известкования и азотного питания.

Перспективные направления дальнейших исследований включают: (i) увеличение обучающей выборки за счёт многолетнего мониторинга и включения данных соседних регионов; (ii) применение self-supervised pretraining на неразмеченных спутниковых данных для повышения качества DL-моделей; (iii) интеграцию данных гиперспектральных миссий (EnMAP, PRISMA) по мере расширения их пространственного покрытия; (iv) разработку гибридных ансамблей, объединяющих табличные ML и CNN-модели.

---

## Список литературы

1. McBratney, A. B., Mendonça Santos, M. L., & Minasny, B. (2003). On digital soil mapping. *Geoderma*, 117(1-2), 3-52.
2. Wadoux, A. M., Minasny, B., & McBratney, A. B. (2020). Machine learning for digital soil mapping: A review. *Geoderma*, 370, 114357.
3. Behrens, T., Schmidt, K., MacMillan, R. A., & Viscarra Rossel, R. A. (2018). Multi-scale digital soil mapping with deep learning. *Scientific Reports*, 8(1), 15244.
4. Hengl, T., et al. (2017). SoilGrids250m: Global gridded soil information based on machine learning. *PLoS ONE*, 12(2), e0169748.
5. Breiman, L. (2001). Random forests. *Machine Learning*, 45(1), 5-32.
6. Chen, T., & Guestrin, C. (2016). XGBoost: A scalable tree boosting system. *Proceedings of the 22nd ACM SIGKDD*, 785-794.
7. Dorogush, A. V., Ershov, V., & Gulin, A. (2018). CatBoost: gradient boosting with categorical features support. *arXiv preprint arXiv:1810.11363*.
8. He, K., Zhang, X., Ren, S., & Sun, J. (2016). Deep residual learning for image recognition. *CVPR*, 770-778.
9. Liu, Z., et al. (2022). A ConvNet for the 2020s. *CVPR*, 11976-11986.
10. Roberts, D. R., et al. (2017). Cross-validation strategies for data with temporal, spatial, hierarchical, or phylogenetic structure. *Ecography*, 40(8), 913-929.
11. Geurts, P., Ernst, D., & Wehenkel, L. (2006). Extremely randomized trees. *Machine Learning*, 63(1), 3-42.
12. Drucker, H., Burges, C. J., Kaufman, L., Smola, A., & Vapnik, V. (1997). Support vector regression machines. *Advances in NIPS*, 9.
13. Padarian, J., Minasny, B., & McBratney, A. B. (2019). Using deep learning for digital soil mapping. *Soil*, 5(1), 79-89.
14. Castaldi, F., et al. (2019). Evaluating the capability of the Sentinel-2 data for soil organic carbon prediction in croplands. *ISPRS Journal*, 147, 267-282.
15. Vaudour, E., et al. (2019). Sentinel-2 image capacities to predict common topsoil properties of temperate and Mediterranean agroecosystems. *Remote Sensing of Environment*, 223, 21-33.
16. Haralick, R. M., Shanmugam, K., & Dinstein, I. H. (1973). Textural features for image classification. *IEEE Transactions on Systems, Man, and Cybernetics*, (6), 610-621.
17. Hu, J., Shen, L., & Sun, G. (2018). Squeeze-and-excitation networks. *CVPR*, 7132-7141.
18. Muñoz-Sabater, J., et al. (2021). ERA5-Land: A state-of-the-art global reanalysis dataset for land applications. *Earth System Science Data*, 13(9), 4349-4383.
19. Drusch, M., et al. (2012). Sentinel-2: ESA's optical high-resolution mission for GMES operational services. *Remote Sensing of Environment*, 120, 25-36.
20. Torres, R., et al. (2012). GMES Sentinel-1 mission. *Remote Sensing of Environment*, 120, 9-24.
21. Van Bemmelen, J. M. (1890). Über die Bestimmung des Wassers, des Humus, des Schwefels, der in den colloidalen Silikaten gebundenen Kieselsäure, des Mangans u.s.w. im Ackerboden. *Landwirtschaftliche Versuchs-Stationen*, 37, 279-290.
22. Fick, S. E., & Hijmans, R. J. (2017). WorldClim 2: new 1-km spatial resolution climate surfaces for global land areas. *International Journal of Climatology*, 37(12), 4302-4315.
23. Friedman, J. H. (2001). Greedy function approximation: A gradient boosting machine. *Annals of Statistics*, 1189-1232.
24. Pedregosa, F., et al. (2011). Scikit-learn: Machine learning in Python. *JMLR*, 12, 2825-2830.
25. Paszke, A., et al. (2019). PyTorch: An imperative style, high-performance deep learning library. *NeurIPS*.
26. Gebbers, R., & Adamchuk, V. I. (2010). Precision agriculture and food security. *Science*, 327(5967), 828-831.
27. Viscarra Rossel, R. A., et al. (2006). Visible, near infrared, mid infrared or combined diffuse reflectance spectroscopy for simultaneous assessment of various soil properties. *Geoderma*, 131(1-2), 59-75.
28. Swinnen, J., Burkitbayeva, S., Schierhorn, F., Prishchepov, A. V., & Müller, D. (2017). Production potential in the "bread baskets" of Eastern Europe and Central Asia. *Global Food Security*, 14, 38-53.
29. Kraemer, R., Prishchepov, A. V., Müller, D., Kuemmerle, T., Radeloff, V. C., Dara, A., ... & Frühauf, M. (2015). Long-term agricultural land-cover change and potential for cropland expansion in the former Virgin Lands area of Kazakhstan. *Environmental Research Letters*, 10(5), 054012.
30. Ben-Dor, E., Chabrillat, S., Demattê, J. A. M., Taylor, G. R., Hill, J., Whiting, M. L., & Sommer, S. (2009). Using imaging spectroscopy to study soil properties. *Remote Sensing of Environment*, 113, S38-S55.
31. Viscarra Rossel, R. A., & Behrens, T. (2010). Using data mining to model and interpret soil diffuse reflectance spectra. *Geoderma*, 158(1-2), 46-54.
32. Roy, D. P., et al. (2014). Landsat-8: Science and product vision for terrestrial global change research. *Remote Sensing of Environment*, 145, 154-172.
33. Bauer-Marschallinger, B., et al. (2019). Toward global soil moisture monitoring with Sentinel-1: Harnessing assets and overcoming obstacles. *IEEE Transactions on Geoscience and Remote Sensing*, 57(1), 520-539.
34. Wilson, J. P., & Gallant, J. C. (2000). *Terrain Analysis: Principles and Applications*. John Wiley & Sons.
35. Žížala, D., Minařík, R., & Zádorová, T. (2022). Soil organic carbon mapping using multitemporal Sentinel-2 data: A comparison of machine learning methods. *Remote Sensing*, 14(8), 1941.
36. Wadoux, A. M. J.-C. (2019). Using deep learning for multivariate mapping of soil with quantified uncertainty. *Geoderma*, 351, 59-70.
37. Wadoux, A. M. J.-C., Heuvelink, G. B. M., de Bruin, S., & Brus, D. J. (2021). Spatial cross-validation is not the right way to evaluate map accuracy. *Ecological Modelling*, 457, 109692.
38. Meyer, H., & Pebesma, E. (2021). Predicting into unknown space? Estimating the area of applicability of spatial prediction models. *Methods in Ecology and Evolution*, 12(9), 1620-1633.
39. Gorelick, N., Hancher, M., Dixon, M., Ilyushchenko, S., Thau, D., & Moore, R. (2017). Google Earth Engine: Planetary-scale geospatial analysis for everyone. *Remote Sensing of Environment*, 202, 18-27.
40. Tucker, C. J. (1979). Red and photographic infrared linear combinations for monitoring vegetation. *Remote Sensing of Environment*, 8(2), 127-150.
41. Hastie, T., Tibshirani, R., & Friedman, J. (2009). *The Elements of Statistical Learning*. Springer.
42. Hughes, G. (1968). On the mean accuracy of statistical pattern recognizers. *IEEE Transactions on Information Theory*, 14(1), 55-63.
43. Zhong, L., Guo, X., Xu, Z., & Ding, M. (2024). Soil properties prediction using deep learning approaches for multitemporal remote sensing. *Geoderma*, 441, 116753.
44. FAO (2015). *Status of the World's Soil Resources: Main Report*. Food and Agriculture Organization of the United Nations, Rome.
